var cChannels=cChannels||{channelArray:new Array};cChannels.initChannels=function(){cChannels.channelArray.push({displayName:"Opacity",name:"opacity",cssNames:["opacity"],template:"timeline_channel_simple",getValue:function(a){return 100*a.style.opacity||100},applyValue:function(a,b){a.style.opacity=b/100}}),cChannels.channelArray.push({displayName:"X position",name:"xposition",propertyNames:["left"],template:"timeline_channel_simple",getValue:function(a){return console.log(a),parseInt(a.style.left)},applyValue:function(a,b){a.style.left=b+"px"}}),cChannels.channelArray.push({displayName:"Y position",name:"yposition",propertyNames:["top"],template:"timeline_channel_simple",getValue:function(a){return console.log(a),parseInt(a.style.top)},applyValue:function(a,b){a.style.top=b+"px"}}),cChannels.channelArray.push({displayName:"Scale",name:"scale",template:"timeline_channel_scale",propertyNames:["transform","-webkit-transform","-ms-transform","moz-transform"],components:["scaleX","scaleY"],getValue:function(a){var b=cChannels.decomposeMatrix(cChannels.getTransformMatrixFromElement(a));return{x:b.scaleX,y:b.scaleY}},applyValue:function(a,b){var c=a.style,d="scale("+b.x+","+b.y+")",e=cChannels.addTransformCompnent(c,d,"scale");a.style.transform=e,a.style.webkitTransform=e}}),cChannels.channelArray.push({displayName:"Rotation",name:"rotation",propertyNames:["transform","-webkit-transform","-ms-transform"],components:["rotate"],template:"timeline_channel_simple",getValue:function(a){var b=cChannels.getTransformMatrixFromElement(a);console.log(b);var c=cChannels.decomposeMatrix(b);return c.rotation},applyValue:function(a,b){var c=a.style,d="rotate("+b+"deg)",e=cChannels.addTransformCompnent(c,d,"rotate");a.style.transform=e,a.style.webkitTransform=e}})},cChannels.getChannelFromName=function(a){for(var b in cChannels.channelArray)if(b=cChannels.channelArray[b],b.name===a)return b;return null},cChannels.getCurrentValueForChannel=function(a,b,c){var d=cChannels.getChannelFromName(b);return d.getValue(a)},cChannels.applyValueToChannel=function(a,b,c,d){var e=cChannels.getChannelFromName(c);e.applyValue(a,b)},cChannels.deltaTransformPoint=function(a,b){var c=b.x*a.a+b.y*a.c+0,d=b.x*a.b+b.y*a.d+0;return{x:c,y:d}},cChannels.decomposeMatrix=function(a){var b=cChannels.deltaTransformPoint(a,{x:0,y:1}),c=cChannels.deltaTransformPoint(a,{x:1,y:0}),d=180/Math.PI*Math.atan2(b.y,b.x)-90,e=180/Math.PI*Math.atan2(c.y,c.x);return{translateX:a.e,translateY:a.f,scaleX:Math.sqrt(a.a*a.a+a.b*a.b),scaleY:Math.sqrt(a.c*a.c+a.d*a.d),skewX:d,skewY:e,rotation:d}},cChannels.getTransformMatrixFromElement=function(a){var b=window.getComputedStyle(a,null),c=b.getPropertyValue("transform")||b.getPropertyValue("-webkit-transform")||b.getPropertyValue("-ms-transform"),d=c.split("(")[1];d=d.split(")")[0],d=d.split(",");var e={};return e.a=d[0],e.b=d[1],e.c=d[2],e.d=d[3],e.e=d[4],e.f=d[5],e},cChannels.addTransformCompnent=function(a,b,c){var d=a.transform||a.webkitTransform;if("string"==typeof d){var e=d.split("s+"),f="";for(var g in e)e[g].match("^"+c)||(f+=e[g]+" ");return f+=b}return""},cChannels.initChannels(),function(){for(var a=0,b=["webkit","moz"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var TinyAnim={anim:null,targetEl:null,currentFrame:0,fps:null,interval:null,elements:null,onAdvanceFrame:null,onAnimationComplete:null,isPlaying:!1,options:null,playCount:0,animStartTime:0};TinyAnim.init=function(a,b,c){TinyAnim.anim=a,TinyAnim.targetEl=b||"Content",TinyAnim.fps=1e3/a.fps,TinyAnim.options=c||null,TinyAnim.elements=Array();for(var d in a.elements)a.elements[d].content=unescape(a.elements[d].content);for(var e=document.getElementById(TinyAnim.targetEl);e.firstChild;)e.removeChild(e.firstChild);var f=new Array;for(var g in TinyAnim.anim.elements){var h=TinyAnim.anim.elements[g],i=document.createElement("div");i.setAttribute("id","TAnimEl"+g),i.setAttribute("name",h.name),i.setAttribute("data-guid",h.guid||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})),void 0!==h.parent&&null!==h.parent?(i.setAttribute("parent",h.parent),f.push(i)):void 0!==h.parentName&&null!==h.parentName&&(i.setAttribute("parentName",h.parentName),f.push(i)),i.setAttribute("class","ill-anim-element"),i.setAttribute("data-layer-id",g),i.style.zIndex=h.zindex,i.style.top=h.defaultTop+"px",i.style.left=h.defaultLeft+"px",i.animdata=h,i.innerHTML=h.content,TinyAnim.elements.push(i),document.getElementById("Content").appendChild(i)}for(var j in f){var k=f[j],l=k.getAttribute("parent");if(null!=l){var m=document.querySelectorAll('[data-guid="'+l+'"]');m[0].appendChild(k)}else{console.log(k);var n=k.getAttribute("parentName"),m=document.querySelectorAll('[name="'+n+'"]');m[0].appendChild(k)}}},TinyAnim.lerp=function(a,b,c,d){switch(d){case"linear":return a+c*(b-a);case"ease-out":return c=Math.sin(1.5707*c),a+c*(b-a);case"ease-in":return c=Math.cos(1.5707*c),a+c*(b-a);case"bounce":return c=Math.cos(1.57079632*c*2)/2+.5,a+c*(b-a);default:return a+c*(b-a)}},TinyAnim.play=function(){0==TinyAnim.isPlaying&&(TinyAnim.isPlaying=!0,TinyAnim.animStartTime=(new Date).getTime()-TinyAnim.currentFrame*TinyAnim.fps,TinyAnim.advanceFrameWhilePlaying())},TinyAnim.advanceFrameWhilePlaying=function(){var a=(new Date).getTime(),b=a-TinyAnim.animStartTime;TinyAnim.currentFrame=b/TinyAnim.fps,TinyAnim.updateAnimation(),TinyAnim.currentFrame>TinyAnim.anim.length&&TinyAnim.playbackEnded(),TinyAnim.onAdvanceFrame&&TinyAnim.onAdvanceFrame(),TinyAnim.isPlaying&&window.requestAnimationFrame(function(){TinyAnim.advanceFrameWhilePlaying()})},TinyAnim.playbackEnded=function(){if(TinyAnim.playCount++,TinyAnim.onAnimationComplete&&TinyAnim.onAnimationComplete(),"undefined"==typeof Project)switch(TinyAnim.options.playback){case"play_forever":TinyAnim.seek(0),setTimeout(function(){TinyAnim.play()},1);break;case"play_n_times":var a=parseInt(TinyAnim.options.loopcount),b=TinyAnim.playCount;console.log(a,b),a>b?(TinyAnim.seek(0),setTimeout(function(){TinyAnim.play()},1)):TinyAnim.isPlaying=!1;default:TinyAnim.isPlaying=!1}},TinyAnim.seek=function(a){TinyAnim.currentFrame=a,TinyAnim.animStartTime=(new Date).getTime()-TinyAnim.currentFrame*TinyAnim.fps,TinyAnim.updateAnimation()},TinyAnim.stop=function(){TinyAnim.isPlaying=!1},TinyAnim.updateAnimation=function(){for(var a in TinyAnim.elements){var b=TinyAnim.elements[a],c=b.animdata.keys;for(var d in c){var e,f,g=c[d],h=!1;if(g.keys.length>0){if(TinyAnim.currentFrame<g.keys[0].time&&(h=!0,e=0,f=0),TinyAnim.currentFrame>g.keys[g.keys.length-1].time&&(h=!0,e=g.keys.length-1,f=g.keys.length-1),h===!1)for(var i=0;i<g.keys.length;i++)if(TinyAnim.currentFrame>=g.keys[i].time)if(i+1<g.keys.length){if(TinyAnim.currentFrame<g.keys[i+1].time){e=i,f=i+1;break}e=i,f=i}else e=i,f=i;var j=g.channel,k=g.keys[f].time-g.keys[e].time,l=TinyAnim.currentFrame-g.keys[e].time;if(e!=f)var m=1-l/k;else var m=0;var n=g.keys[e].value,o=g.keys[f].value,p=g.keys[e].easing||"bounce";if("number"==typeof n&&"number"==typeof o)var q=TinyAnim.lerp(g.keys[e].value,g.keys[f].value,m,p);else{var q={};for(var r in n)if(n.hasOwnProperty(r)){var s=n[r],t=o[r],u=TinyAnim.lerp(s,t,m,p);q[r]=u}}cChannels.applyValueToChannel(b,q,j,null)}}}},TinyAnim.resolveGUID=function(a){for(var b in TinyAnim.anim.elements){var c=TinyAnim.anim.elements[b];if(c.guid==a)return c}return null},TinyAnim.checkCyclical=function(a,b,c){if(null!==a.parent){var d=TinyAnim.resolveGUID(a.parent);d.guid==b?c(!1):TinyAnim.checkCyclical(d,b,c)}else c(!0)};